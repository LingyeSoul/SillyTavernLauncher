import pystray
from PIL import Image
from io import BytesIO
import base64
import re
from core.event import UiEvent
class Tray:
    def _base64_to_image(self,base64_str: str) -> Image.Image:
        base64_data = re.sub('^data:image/.+;base64,', '', base64_str)
        byte_data = base64.b64decode(base64_data)
        image_data = BytesIO(byte_data)
        img = Image.open(image_data)
        return img
    def __init__(self,page,UiEvent:UiEvent):
        self.ui_event = UiEvent
        self.page = page
        iconb64='''data:image/png;base64,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'''
        tray_image = self._base64_to_image(iconb64)
        self.tray=pystray.Icon('SillyTavernLauncher',icon=tray_image)
        
        self.tray.menu=pystray.Menu(
            pystray.MenuItem('打开主窗口',self.open_app),
            pystray.MenuItem('启动酒馆',self.start_st),
            pystray.MenuItem('关闭酒馆',self.stop_st),
            pystray.MenuItem('重启酒馆',self.restart_st),
            pystray.MenuItem('退出启动器',self.exit_app),
                            )
        self.tray.run_detached()

    def open_app(self, icon, query):
        """打开主窗口（从托盘）"""
        if self.ui_event:
            self.ui_event.open_window()

    def exit_app(self, icon, query):
        """
        从托盘退出应用程序

        设计说明（保证用户体验）：
        1. 先立即停止托盘图标
        2. 调用 ui_event.exit_app_with_tray() 处理窗口隐藏、进程停止和UI清理

        注意：窗口隐藏现在由 ui_event.exit_app_with_tray() 统一处理
        """
        # 步骤 1: 停止托盘图标
        try:
            self.tray.stop()
        except Exception as e:
            pass  # 托盘可能已经停止

        # 步骤 2: 调用 ui_event 处理窗口隐藏、进程停止和异步销毁
        if self.ui_event:
            self.ui_event.exit_app_with_tray(None)

    def restart_st(self, icon, query):
        if self.ui_event:
            self.ui_event.restart_sillytavern(None)

    def start_st(self, icon, query):
        if self.ui_event:
            self.ui_event.start_sillytavern(None)

    def stop_st(self, icon, query):
        if self.ui_event:
            self.ui_event.stop_sillytavern(None)